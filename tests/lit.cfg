# vim:syntax=python

try:
	import lit

except ImportError:
	import lit36 as lit

config.name = 'Fabrique'
config.suffixes = [ '.fab' ]
config.excludes = [ 'Inputs', 'manifest.fab' ]
config.test_format = lit.formats.ShTest()

root = os.path.dirname(os.path.dirname(os.path.realpath(__file__)))
litdir = os.path.dirname(sys.argv[0])
path = config.environment['PATH']
path = os.path.pathsep.join((litdir, path))
config.environment['PATH'] = path


params = lit_config.params

builddir = params['build-dir'] if 'build-dir' in params else os.path.join(root, 'build')

config.substitutions += [
	('%fab', os.path.join(builddir, 'bin', 'fab')),
]

if 'output-dir' in params:
	config.test_exec_root = params['output-dir']
else:
	import tempfile
	config.test_exec_root = tempfile.mkdtemp(prefix = 'fabrique-test')
